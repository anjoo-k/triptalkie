<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layouts/base}">

<main layout:fragment="content">
	<h4 class="text-center content--title">여행 정보 게시판</h4>

	<div class="travel-info-containers bg--containers pt-5 pb-5">
		<!-- 검색 폼 -->
		<div class="form-container mb-3">
			<form th:action="@{/travel-info/list}" method="get">
				<div class="form-group row">
					<div class="col-sm-10">
						<input type="text" name="keyword" class="form-control search-box"
							placeholder="무엇을 찾아볼까요?" th:value="${keyword}">
					</div>
					<div class="col-sm-2">
						<button type="submit" class="btn btn-block btn-search">검색</button>
					</div>
				</div>

				<!-- 카테고리 필터 -->
				<div class="form-group row">
					<div class="col-md">
						<select class="form-control select-box" name="infotype">
							<option value="">정보 종류</option>
							<option value="팁">팁</option>
							<option value="교통">교통</option>
							<option value="숙박">숙박</option>
							<option value="음식점">음식점</option>
							<option value="관광지">관광지</option>
							<option value="축제">축제</option>
							<option value="비용">비용</option>
							<option value="안전">안전</option>
							<option value="날씨">날씨</option>
							<option value="기타">기타</option>
						</select>
					</div>

					<div class="col-md">
						<select id="countrySelect" class="form-control select-box mr-2"
							name="countryId">
							<option value="">나라 선택</option>
							<option th:each="country : ${countryList}"
								th:value="${country.id}" th:text="${country.name}"></option>
						</select>
					</div>

					<div class="col-md">
						<select id="citySelect" class="form-control select-box mr-2"
							name="cityId">
							<option value="">도시 선택</option>
						</select>
					</div>
				</div>
			</form>
		</div>

		<div class="board-divider mx-4 px-2"></div>

		<!-- 리스트 -->
		<div class="info-list-container mt-4 mx-4">
			<div th:if="${travelInfoList != null}"
				th:each="info, stat : ${travelInfoList}">
				<div class="card mb-3">
					<div class="card-body card-body-grid d-flex align-items-center">
						<div class="number mr-3"
							th:text="${(pageData.currentPage - 1) * pageData.size + stat.index + 1}">1</div>

						<div class="right-content flex-fill">
							<!-- 1행 : 지역 + 조회수 -->
							<div class="row-badges mb-1">
								<span class="badge badge--category" th:text="${info.cityName}">지역</span>
								<span class="badge--sub-desc" th:text="|조회수 · ${info.view}|">조회수</span>

							</div>
							<!-- 2행 : 글 제목 + 닉네임 + 글쓴 날짜 -->
							<div class="row-stats mb-1">
								<a th:href="@{/travel-info/detail/{idx}(idx=${info.idx})}"
									class="card-title h5 mb-1 title list-title"
									th:data-id="${info.idx}" th:text="${info.title}">글 제목</a> <span
									class="badge--sub-desc" th:text="${info.memberNickname}">작성자</span>
								<span class="badge--sub-desc"
									th:text="${#temporals.format(info.createdAt, 'yyyy-MM-dd')}">글작성일</span>
							</div>
							<!-- 3행 : 여행 정보 종류, 여행 정보 기준일 -->
							<div>
								<span th:text="${info.infotype}">여행 정보</span> <span
									class="badge--sub-desc"
									th:text="${info.infodate != null ? #temporals.format(info.infodate, 'yyyy-MM') : ''}">여행정보기준일</span>
							</div>
						</div>
					</div>
				</div>

				<div class="card-divider" th:if="${!stat.last}"></div>
			</div>
			<div
				th:if="${travelInfoList == null or #lists.isEmpty(travelInfoList)}"
				class="text-center p-3">검색 결과가 없습니다.</div>
		</div>


		<!-- 페이지네이션 + 글쓰기 버튼 -->
		<div class="row mt-4 mb-3 align-items-center">

			<!-- 페이지네이션 -->
			<div class="col d-flex justify-content-center">
				<nav aria-label="페이지 네비게이션">
					<ul class="pagination pagination-sm mb-0">

						<!-- 맨 처음 -->
						<li class="page-item"
							th:classappend="${pageData.currentPage == 1} ? 'disabled'">
							<a class="page-link"
							th:href="@{/travel-info/list(page=1, size=${pageData.size})}">&laquo;</a>
						</li>

						<!-- 이전 블록 -->
						<li class="page-item"
							th:classappend="${pageData.startPage == 1} ? 'disabled'"><a
							class="page-link"
							th:href="@{/travel-info/list(page=${pageData.startPage - 1}, size=${pageData.size})}">
								이전 </a></li>

						<!-- 페이지 번호 -->
						<li class="page-item"
							th:each="p : ${#numbers.sequence(pageData.startPage, pageData.endPage)}"
							th:classappend="${p == pageData.currentPage} ? 'active'"><a
							class="page-link" th:text="${p}"
							th:href="@{/travel-info/list(page=${p}, size=${pageData.size})}">
						</a></li>

						<!-- 다음 블록 -->
						<li class="page-item"
							th:classappend="${pageData.endPage == pageData.totalPage} ? 'disabled'">
							<a class="page-link"
							th:href="@{/travel-info/list(page=${pageData.endPage + 1}, size=${pageData.size})}">
								다음 </a>
						</li>

						<!-- 맨 끝 -->
						<li class="page-item"
							th:classappend="${pageData.currentPage == pageData.totalPage} ? 'disabled'">
							<a class="page-link"
							th:href="@{/travel-info/list(page=${pageData.totalPage}, size=${pageData.size})}">&raquo;</a>
						</li>

					</ul>
				</nav>
			</div>

			<!-- 글쓰기 버튼 -->
			<div class="col-auto">
				<a class="btn btn-primary btn-sm" th:href="@{/travel-info/register}">
					✍ 글쓰기 </a>
			</div>
		</div>

	</div>
</main>
</html>
