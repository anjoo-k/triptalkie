<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper
	namespace="com.walkietalkie.triptalkie.mapper.CustomerserviceMapper">
	<select id="findAllFqa">
		SELECT idx, title, view, content, created_at,
		member_id
		FROM faq
		ORDER BY created_at DESC
	</select>

	<select id="findCountFaq">
		SELECT COUNT(*) FROM faq
	</select>

	<select id="findFaqPaged" resultType="map" parameterType="map">
		SELECT
		idx, title, view, content, created_at, member_id
		FROM faq
		ORDER BY created_at DESC
		LIMIT #{startRow}, #{size}
	</select>
	
		<!-- 총 글 갯수 + 검색 -->
	<select id="countNotice" resultType="int">
		SELECT COUNT(*)
		FROM notice
	</select>
	<!-- 목록 조회 -->
	<select id="findNoticeAllList">
		SELECT idx, title, content, created_at, updated_at
		FROM notice
		ORDER BY created_at DESC
		LIMIT #{size} OFFSET #{offset}
	</select>
	
	<update id="increaseViewCount">
		UPDATE notice
		SET view = view + 1
		WHERE idx=#{noticeId}
	</update>
	<select id="findNoticeByIdx">
		SELECT idx, title, content, created_at, updated_at
		FROM notice
		WHERE idx=#{noticeId}
	</select>
	<!-- 메인에 조회수 별 5개 질문 조회 -->
	<select id="findFaqTop5">
		SELECT idx, title, view, content, created_at,
		member_id
		FROM faq
		ORDER BY view DESC
		LIMIT 5
	</select>
	<!-- 메인에 공지사항 최신 순 5개 조회 -->
	<select id="findNoticeTop5">
		SELECT idx, title, view, content, created_at
		FROM notice
		ORDER BY created_at DESC
		LIMIT 5
	</select>
	
	<select id="findCountQna">
		SELECT COUNT(*) FROM qna
	</select>

	<select id="findQnaPaged" resultType="map" parameterType="map">
		SELECT
		q.idx, q.title, q.content, q.member_id, m.nickname, q.view, q.created_at
		FROM qna q
        LEFT JOIN member m ON q.member_id = m.id
		ORDER BY created_at DESC
		LIMIT #{startRow}, #{size}
	</select>
</mapper>